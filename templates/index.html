{% extends "base.html" %}

{% block title %}ExpiryTrack - Historical Data Collection{% endblock %}

{% block content %}
    <!-- Hero Section -->
    <div class="hero min-h-screen bg-gradient-to-b from-emerald-50 to-white -mt-8">
        <div class="hero-content text-center">
            <div class="max-w-2xl">
                <h1 class="text-5xl font-bold supabase-text-gradient">
                    ExpiryTrack
                </h1>
                <p class="py-6 text-lg">
                    Automated Historical Data Collection for Expired Derivatives Contracts
                </p>

                {% if is_authenticated %}
                <!-- Authenticated View -->
                <div class="card-minimal">
                    <div class="p-8">
                        <h2 class="text-xl font-semibold text-green-600 mb-4">Authenticated</h2>

                        {% if stats %}
                        <div class="grid grid-cols-3 gap-4 mb-6">
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">{{ stats.total_instruments }}</div>
                                <div class="text-sm text-gray-600">Instruments</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">{{ "{:,}".format(stats.total_contracts) }}</div>
                                <div class="text-sm text-gray-600">Contracts</div>
                            </div>
                            <div class="text-center">
                                <div class="text-2xl font-bold text-gray-800">{{ "{:,}".format(stats.total_candles) }}</div>
                                <div class="text-sm text-gray-600">Candles</div>
                            </div>
                        </div>
                        {% endif %}

                        <div class="flex gap-4 justify-center">
                            <a href="/collect" class="btn-supabase">Start Data Collection</a>
                            <a href="{{ url_for('status_page') }}" class="btn bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium py-2 px-4 rounded-lg">View Statistics</a>
                        </div>
                    </div>
                </div>
                {% else %}
                <!-- Not Authenticated View -->
                <div class="card-minimal">
                    <div class="p-8">
                        <h2 class="text-xl font-semibold mb-4">Get Started</h2>
                        <p class="text-gray-600 mb-6">Connect your Upstox account to start collecting expired contract data</p>

                        <div class="card-minimal p-4 mb-4 border-amber-200 bg-amber-50">
                            <p class="text-amber-800 text-sm font-medium mb-1">⚠️ Upstox Plus Plan Required</p>
                            <p class="text-amber-700 text-xs">ExpiryTrack requires the Upstox Plus Plan to access expired contract data. Currently free to activate.</p>
                        </div>

                        <div class="card-minimal p-4 mb-6 border-blue-200 bg-blue-50">
                            <p class="text-blue-800 text-sm">Make sure you've configured your API credentials in Settings first!</p>
                        </div>

                        <div class="flex gap-4 justify-center">
                            <a href="/settings" class="btn bg-gray-100 text-gray-700 hover:bg-gray-200 font-medium py-2 px-4 rounded-lg">Configure Settings</a>
                            <a href="/login" class="btn-supabase">Login with Upstox</a>
                        </div>
                    </div>
                </div>
                {% endif %}

                <!-- Features -->
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6 mt-12">
                    <div class="card-minimal text-center">
                        <div class="p-6">
                            <h4 class="font-semibold text-gray-800 mb-2">Complete Coverage</h4>
                            <p class="text-sm text-gray-600">All options & futures contracts</p>
                        </div>
                    </div>
                    <div class="card-minimal text-center">
                        <div class="p-6">
                            <h4 class="font-semibold text-gray-800 mb-2">High Speed</h4>
                            <p class="text-sm text-gray-600">50 requests per second</p>
                        </div>
                    </div>
                    <div class="card-minimal text-center">
                        <div class="p-6">
                            <h4 class="font-semibold text-gray-800 mb-2">OpenAlgo Symbols</h4>
                            <p class="text-sm text-gray-600">User-friendly data export</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
{% endblock %}